;*=====================================================================*/
;*    serrano/uni/97-98/maitrise/compil/cgc/Tools/speek.scm            */
;*    -------------------------------------------------------------    */
;*    Author      :  Manuel Serrano                                    */
;*    Creation    :  Mon Jan 26 09:29:36 1998                          */
;*    Last change :  Fri Feb  6 14:26:41 1998 (serrano)                */
;*    -------------------------------------------------------------    */
;*    Gosips implementation                                            */
;*=====================================================================*/

;*---------------------------------------------------------------------*/
;*    Le module                                                        */
;*---------------------------------------------------------------------*/
(module tools_speek
   (import  engine_param)
   (export  (verbose-level? level)
	    (verbose level . args)
	    (fprin   port . obj)))

;*---------------------------------------------------------------------*/
;*    verbose-level? ...                                               */
;*---------------------------------------------------------------------*/
(define (verbose-level? level)
   (<= level *verbose*))

;*---------------------------------------------------------------------*/
;*    speek ...                                                        */
;*---------------------------------------------------------------------*/
(define (speek port flag args)
   (if flag
       (begin
	  (for-each (lambda (v) (display v port)) args)
	  (flush-output-port port))))

;*---------------------------------------------------------------------*/
;*    verbose ...                                                      */
;*---------------------------------------------------------------------*/
(define (verbose level . args)
   (let ((port (if (string? *dest*)
		   (current-output-port)
		   (current-error-port))))
      (speek port (verbose-level? level) args)))
   
;*---------------------------------------------------------------------*/
;*    fprin ...                                                        */
;*---------------------------------------------------------------------*/
(define (fprin port . obj)
   (for-each (lambda (o) (display o port)) obj))

