#*=====================================================================*/
#*    serrano/diffusion/article/bjvm/bench/makes/Makefile.gambit       */
#*    -------------------------------------------------------------    */
#*    Author      :  Manuel Serrano                                    */
#*    Creation    :  Wed Jan 17 14:34:35 2001                          */
#*    Last change :  Mon Feb 26 19:21:09 2001 (serrano)                */
#*    Copyright   :  2001 Manuel Serrano                               */
#*    -------------------------------------------------------------    */
#*    The standard Makefile to compile Gambit benchamrks.              */
#*=====================================================================*/
#*---------------------------------------------------------------------*/
#*    The compile and flags                                            */
#*---------------------------------------------------------------------*/
GAMBIT=gsc
CC=gcc -O3
GFLAGS=-f -prelude "(declare (ieee-scheme) (block) (not interrupts-enabled) (not safe) (extended-bindings) (standard-bindings) (inlining-limit 1000))"

#*---------------------------------------------------------------------*/
#*    Basename and objects                                             */
#*---------------------------------------------------------------------*/
BENCH=
OBJECTS=$(BENCH).o

#*---------------------------------------------------------------------*/
#*    Jvm entry                                                        */
#*---------------------------------------------------------------------*/
a.gambit: $(OBJECTS)
	$(CC) -o a.gambit $(OBJECTS) $(OBJECTS:%.o=%_.o) -lgambc

#*---------------------------------------------------------------------*/
#*    clean:                                                           */
#*---------------------------------------------------------------------*/
clean:
	/bin/rm -f $(OBJECTS)
	/bin/rm -f a.gambit
	/bin/rm -f *.o
	/bin/rm -f *.c
	cleanup

#*---------------------------------------------------------------------*/
#*    Implicit rules                                                   */
#*---------------------------------------------------------------------*/
%.o: %.scm
	$(GAMBIT) $(GFLAGS) $*.scm
	$(CC) $*.c $*_.c -c
